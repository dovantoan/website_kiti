@using titi.Areas.Admin.Models
@using titi.Helper
@using System.Linq
@using Util.Entity;
@{
    ViewBag.Title = "Danh sách đơn đặt hàng";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAdmin.cshtml";
    List<OrderViewEntity> list = ViewBag.Data;
}
<link href="~/Areas/Admin/Content/plugins/footable/footable.core.css" rel="stylesheet" />
<div class="wrapper wrapper-content animated fadeIn">
    <div class="row">
        <div class="col-lg-12">
            <div class="ibox">
                <div class="ibox-title">Danh sách đơn đặt hàng</div>
                <div class="ibox-content">
                    @Html.AntiForgeryToken()
                    <div class="row">
                        <table class="footable table table-stripped toggle-arrow-tiny" data-page-size="50">
                            <thead>
                                <tr>
                                    <th data-toggle="true">STT</th>
                                    <th>Mã đơn hàng</th>
                                    <th>Tổng số tiền</th>
                                    <th>Ngày đặt</th>
                                    <th>Người đặt hàng</th>
                                    <th>Số điện thoại khách hàng</th>
                                    <th>Địa chỉ giao hàng</th>
                                    <th>Hình thức thanh toán</th>
                                    <th>Phí giao hàng</th>
                                    <th>Mô tả phí</th>
                                    <th>Status</th>
                                    <th data-hide="all"></th>
                                </tr>
                            </thead>
                            <tbody>
                                @{ int next = 1;}
                                @foreach (var item in list)
                                {
                                <tr>
                                    <td>@next</td>
                                    <td>@item.OrderCode</td>
                                    <td>@item.FSumAmount</td>
                                    <td>@item.CreatedDate</td>
                                    <td>@item.FullName</td>
                                    <td>@item.PhoneNumber</td>
                                    <td>@item.Address</td>
                                    <td>@item.PaymentMethods</td>
                                    <td>@item.FTruckingAmount</td>
                                    <td>@item.Description</td>
                                    @*<td><a href="#"><i class="fa fa-check text-navy"></i></a></td>*@
                                    <td>@item.Status</td>
                                    <td>
                                        <table class="table table-striped table-bordered table-hover dataTables-example dataTable" width="100%">
                                            <thead>
                                                <tr>
                                                    <th>Mã sản phẩm</th>
                                                    <th>Tên sản phẩm</th>
                                                    <th>Màu sắc</th>
                                                    <th>Size</th>
                                                    <th>Số lượng</th>
                                                    <th>Số tiền</th>
                                                </tr>
                                            </thead>
                                            <tbody>

                                                @if (item.OrderDetails != null)
                                                {
                                                    foreach (var it in item.OrderDetails)
                                                    {
                                                        <tr>
                                                            <td>@it.ProductCode</td>
                                                            <td>@it.ProductName</td>
                                                            <td>@it.ColorValue</td>
                                                            <td>@it.SizeValue</td>
                                                            <td>@it.Quantity</td>
                                                            <td>@it.FAmount</td>
                                                            @*<td><a href="#" onclick="ViewDetail(@it.Pid)" class="btn btn-primary"><i class="fa fa-edit"></i></a> | <a href="@Url.Action("","")" class="btn btn-danger"><i class="fa fa-trash-o"></i></a></td>*@
                                                        </tr>
                                                    }
                                                }
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                                    next++;
                                }

                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="modal inmodal fade" id="addNewModal" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static">
                    <div class="modal-dialog" style="width:800px">
                        <div class="modal-content" style="width:800px">
                            <div id="Reponse_modalWindow">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@section Scripts{
    <script type="text/javascript" charset="utf8" src="~/Areas/Admin/Scripts/plugins/bootstrap-datepicker.js"></script>
    <script src="~/Areas/Admin/Scripts/plugins/sweetalert.min.js"></script>
    <script src="~/Areas/Admin/Scripts/plugins/footable/footable.all.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('.footable').footable();
        })
        function ViewDetail(pid) {
            $.ajax({
                url: "/Category/CategoryDetail",
                method: 'GET',
                data: { categoryId: pid },
                contentType: "application/json; charset=utf-8",
                dataType: "html",
                success: function (response) {
                    $('#Reponse_modalWindow').empty();
                    $('#Reponse_modalWindow').html(response);
                    $('#addNewModal').modal('show');
                    $('#loading-bar').hide();
                },
                failure: function (response) {
                    alert(response.responseText);
                },
                error: function (response) {
                    alert(response.responseText);
                }
            });
        }
        function AddNew() {
            $.ajax({
                url: "/Category/AddNewCategory",
                method: 'GET',
                contentType: "application/json; charset=utf-8",
                dataType: "html",
                success: function (response) {
                    $('#Reponse_modalWindow').empty();
                    $('#Reponse_modalWindow').html(response);
                    $('#addNewModal').modal('show');
                    $('#loading-bar').hide();
                },
                failure: function (response) {
                    alert(response.responseText);
                },
                error: function (response) {
                    alert(response.responseText);
                }
            });
        }

        function Update() {
            $.ajax({
                url: '@Url.Action("UpdateCategory","Category")',
                method: 'POST',
                data: $('#frmUpdateCategory').serialize(),
                dataType: "json",
                beforeSend: function () {

                },
                success: function (response) {
                    if (response.Success) {
                        swal("Updated!", response.Message, "success");
                        //$('#Reponse_modalWindow').empty();
                        //$('#Reponse_modalWindow').html(response);
                        $('#addNewModal').modal('hide');
                        $('#loading-bar').show();
                    }
                    else {
                        swal("Thông báo!", response.Message, "error");
                    }
                },
                failure: function (response) {
                    alert(response.responseText);
                },
                error: function (response) {
                    alert(response.responseText);
                }
            });
        }

        function _doAddNew() {
            $.ajax({
                url: '@Url.Action("InsertCategory", "Category")',
                method: 'POST',
                data: $('#frmAddNewCategory').serialize(),
                dataType: "json",
                beforeSend: function () {

                },
                success: function (response) {
                    if (response.Success) {
                        swal("Updated!", response.Message, "success");
                        //$('#Reponse_modalWindow').empty();
                        //$('#Reponse_modalWindow').html(response);
                        $('#addNewModal').modal('hide');
                        $('#loading-bar').show();
                    }
                    else {
                        swal("Thông báo!", response.Message, "error");
                    }
                },
                failure: function (response) {
                    alert(response.responseText);
                },
                error: function (response) {
                    alert(response.responseText);
                }
            });
        }
    </script>
}
@Styles.Render("~/Areas/Admin/Content/sweetalert.css")
<link href="~/Areas/Admin/font-awesome/css/font-awesome.css" rel="stylesheet" />
<style>
    .footable-row-detail-value {
        width: 100%
    }
</style>